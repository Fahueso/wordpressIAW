

### 1. Crear la carpeta y el archivo del plugin

1. **Ir a la carpeta de plugins:**  
    **Ruta:**  
    `wp-content/plugins/`
    
2. **Crear una carpeta nueva:**  
    **Nombre recomendado:**  
    `mi-menu-admin`
    
3. **Dentro de esa carpeta, crear un archivo PHP:**  
    **Nombre:**  
    `mi-menu-admin.php`
    

---

### 2. Añadir la cabecera del plugin

Abre `mi-menu-admin.php` y pega esto al principio:

```php
<?php
/*
Plugin Name: Mi Menú Admin
Description: Añade un menú personalizado al admin.
Version: 1.0
Author: Francisco
*/
```

- **`Plugin Name`**: nombre que verás en el panel de plugins.
- Si esta cabecera no está bien, WordPress no detecta el plugin.

---

### 3. Registrar el menú en el admin

Debajo de la cabecera, añade:

```php
add_action('admin_menu', 'mma_crear_menu');

function mma_crear_menu() {
    add_menu_page(
        'Notas',             // Título de la página (arriba en la pantalla)
        'Notas',             // Texto que aparece en el menú lateral
        'manage_options',    // Capacidad necesaria (solo admins)
        'mma-notas',         // Slug único de la página
        'mma_pagina_notas',  // Función que pinta el contenido
        'dashicons-edit',    // Icono del menú
        20                   // Posición en el menú
    );
}
```

- **Hook `admin_menu`:** se ejecuta cuando WordPress construye el menú del admin.
- **`add_menu_page`:** registra un nuevo ítem en el menú.

---

### 4. Crear la página del menú y guardar datos

Debajo de lo anterior, añade:

```php
function mma_pagina_notas() {

    // 1. Comprobar si se ha enviado el formulario
    if (isset($_POST['mma_texto'])) {

        // 2. Sanitizar el texto (seguridad)
        $texto_limpio = sanitize_text_field($_POST['mma_texto']);

        // 3. Guardar en la base de datos como opción
        update_option('mma_texto_guardado', $texto_limpio);

        // 4. Mostrar mensaje de éxito
        echo '<div class="updated"><p>Guardado correctamente</p></div>';
    }

    // 5. Recuperar el valor guardado (si existe)
    $texto = get_option('mma_texto_guardado', '');

    // 6. Pintar el formulario
    echo '<div class="wrap">
            <h1>Notas</h1>
            <form method="post">
                <textarea name="mma_texto" rows="5" cols="50">'.esc_textarea($texto).'</textarea>
                <br><br>
                <input type="submit" class="button button-primary" value="Guardar">
            </form>
          </div>';
}
```

**Qué está pasando:**

- **`$_POST['mma_texto']`**: recoge lo que el usuario escribió.
- **`sanitize_text_field`**: limpia el texto para evitar cosas raras.
- **`update_option` / `get_option`**: guardan y leen de la tabla `wp_options`.
- El formulario se envía a la misma página (no hace falta `action`).

---

### 5. Activar y probar

1. Entra en **Escritorio → Plugins**.
2. Activa **“Mi Menú Admin”**.
3. Verás un nuevo ítem en el menú lateral llamado **“Notas”**.
4. Entra, escribe algo, pulsa **Guardar**.
5. Recarga la página: el texto debe seguir ahí.

---
